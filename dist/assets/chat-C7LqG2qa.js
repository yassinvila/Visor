import{j as e,r,c as g}from"./index-D6HAasR3.js";const j=({isConnected:o=!1})=>{const s=()=>{typeof window<"u"&&window.visor?.window?.close&&window.visor.window.close()};return e.jsx("div",{className:"chat-header",style:{WebkitAppRegion:"drag"},children:e.jsxs("div",{className:"header-content",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("span",{className:"chat-status-dot","data-connected":o}),e.jsx("span",{children:"Visor Copilot"})]}),e.jsx("button",{className:"close-button",onClick:s,title:"Close",style:{WebkitAppRegion:"no-drag"},children:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:e.jsx("path",{d:"M1 1L11 11M1 11L11 1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]})})},f=({messages:o,isTyping:s})=>{const t=r.useRef(null),a=()=>{t.current?.scrollIntoView({behavior:"smooth"})};return r.useEffect(()=>{a()},[o,s]),e.jsxs("div",{className:"message-list",children:[o.map(i=>e.jsx("div",{className:`message ${i.role}`,children:e.jsx("div",{className:"message-bubble",children:e.jsx("div",{className:"message-text",children:i.content})})},i.id)),s&&e.jsx("div",{className:"message assistant",children:e.jsx("div",{className:"message-bubble",children:e.jsxs("div",{className:"typing-indicator",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})})}),e.jsx("div",{ref:t})]})},v=({onSendMessage:o,onFocusInput:s})=>{const[t,a]=r.useState(""),i=()=>{t.trim()&&(o(t.trim()),a(""))},h=n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),i())};return e.jsx("div",{className:"chat-input",children:e.jsxs("div",{className:"input-container",children:[e.jsx("textarea",{value:t,onChange:n=>a(n.target.value),onKeyDown:h,onFocus:()=>{window?.visor?.chat?.expand?.(),s?.()},placeholder:"Ask anything",rows:1,className:"input-field"}),e.jsx("button",{onClick:i,disabled:!t.trim(),className:"send-button",title:"Send message",children:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M7 11L12 6L17 11M12 18V7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})})]})})},y=[{id:"c1",role:"assistant",content:"Hi! What workflow should we tackle?",timestamp:new Date}],C=()=>{const[o,s]=r.useState(y),[t,a]=r.useState(!1),[i,h]=r.useState(!1),[n,p]=r.useState(!0),c=typeof window<"u"?window.visor?.chat:void 0;r.useEffect(()=>{let d;return(async()=>{h(!!c)})(),c?.onMessage&&(d=c.onMessage(l=>{s(w=>[...w,{...l,timestamp:new Date}]),a(!1)})),()=>d?.()},[c]);const x=async d=>{const u={id:crypto.randomUUID(),role:"user",content:d.trim(),timestamp:new Date};s(l=>[...l,u]),a(!0),c?.sendMessage?.(u.content),c?.sendMessage||window.setTimeout(()=>{s(l=>[...l,{id:crypto.randomUUID(),role:"assistant",content:"Working on it! I will highlight the next action on screen.",timestamp:new Date}]),a(!1)},1e3)};return e.jsxs("div",{className:`app-container ${n?"collapsed":""}`,children:[!n&&e.jsx(j,{isConnected:i}),!n&&e.jsx(f,{messages:o,isTyping:t}),e.jsx(v,{onSendMessage:x,onFocusInput:()=>p(!1)})]})},m=document.getElementById("root");if(!m)throw new Error("Chat root element not found");const N=g.createRoot(m);N.render(e.jsx(C,{}));
