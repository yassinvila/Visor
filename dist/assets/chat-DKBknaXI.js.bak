import{j as e,r as d,c as y}from"./client-CTQ0Ju4c.js";function _(t){if(t.__esModule)return t;var s=t.default;if(typeof s=="function"){var r=function o(){return this instanceof o?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};r.prototype=s.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var a=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(r,o,a.get?a:{enumerable:!0,get:function(){return t[o]}})}),r}const E={},b=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"})),g=_(b);var m={};const x=g,f=g,j=f.join(__dirname,"path.txt");function N(){let t;if(x.existsSync(j)&&(t=x.readFileSync(j,"utf-8")),m.ELECTRON_OVERRIDE_DIST_PATH)return f.join(m.ELECTRON_OVERRIDE_DIST_PATH,t||"electron");if(t)return f.join(__dirname,"dist",t);throw new Error("Electron failed to install correctly, please delete node_modules/electron and try installing again")}var C=N();const M=({isConnected:t=!1})=>{const s=()=>{C.ipcRenderer.send("window-close")};return e.jsx("div",{className:"chat-header",style:{WebkitAppRegion:"drag"},children:e.jsxs("div",{className:"header-content",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("span",{className:"chat-status-dot","data-connected":t}),e.jsx("span",{children:"Visor Copilot"})]}),e.jsx("button",{className:"close-button",onClick:s,title:"Close",style:{WebkitAppRegion:"no-drag"},children:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:e.jsx("path",{d:"M1 1L11 11M1 11L11 1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]})})},k=({messages:t,isTyping:s})=>{const r=d.useRef(null),o=()=>{var a;(a=r.current)==null||a.scrollIntoView({behavior:"smooth"})};return d.useEffect(()=>{o()},[t,s]),e.jsxs("div",{className:"message-list",children:[t.map(a=>e.jsx("div",{className:`message ${a.role}`,children:e.jsx("div",{className:"message-bubble",children:e.jsx("div",{className:"message-text",children:a.content})})},a.id)),s&&e.jsx("div",{className:"message assistant",children:e.jsx("div",{className:"message-bubble",children:e.jsxs("div",{className:"typing-indicator",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})})}),e.jsx("div",{ref:r})]})},D=({onSendMessage:t})=>{const[s,r]=d.useState(""),o=()=>{s.trim()&&(t(s.trim()),r(""))},a=l=>{l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),o())};return e.jsx("div",{className:"chat-input",children:e.jsxs("div",{className:"input-container",children:[e.jsx("textarea",{value:s,onChange:l=>r(l.target.value),onKeyDown:a,placeholder:"Ask anything",rows:1,className:"input-field"}),e.jsx("button",{onClick:o,disabled:!s.trim(),className:"send-button",title:"Send message",children:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M7 11L12 6L17 11M12 18V7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})})]})})},R=[{id:"c1",role:"assistant",content:"Hi! What workflow should we tackle?",timestamp:new Date}],S=()=>{var h;const[t,s]=d.useState(R),[r,o]=d.useState(!1),[a,l]=d.useState(!1),n=typeof window<"u"?(h=window.visor)==null?void 0:h.chat:void 0;d.useEffect(()=>{let u;return(async()=>{if(!(n!=null&&n.loadHistory)){l(!1);return}const i=await n.loadHistory();i!=null&&i.length&&s(i.map(c=>({...c,timestamp:new Date}))),l(!0)})(),n!=null&&n.onMessage&&(u=n.onMessage(i=>{s(c=>[...c,{...i,timestamp:new Date}]),o(!1)})),()=>u==null?void 0:u()},[n]);const w=async u=>{var i;const p={id:crypto.randomUUID(),role:"user",content:u.trim(),timestamp:new Date};s(c=>[...c,p]),o(!0),(i=n==null?void 0:n.sendMessage)==null||i.call(n,p.content),n!=null&&n.sendMessage||window.setTimeout(()=>{s(c=>[...c,{id:crypto.randomUUID(),role:"assistant",content:"Working on it! I will highlight the next action on screen.",timestamp:new Date}]),o(!1)},1e3)};return e.jsxs("div",{className:"app-container",children:[e.jsx(M,{isConnected:a}),e.jsx(k,{messages:t,isTyping:r}),e.jsx(D,{onSendMessage:w})]})},v=document.getElementById("root");if(!v)throw new Error("Chat root element not found");const I=y(v);I.render(e.jsx(S,{}));
